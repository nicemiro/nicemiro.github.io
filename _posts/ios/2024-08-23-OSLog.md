---
title: 'OSLog, Logger'
titleEn:
author: BabyK
date: 2024-08-23
category: iOS
layout: post
tags: [iOS, Xcode]
published: false
---
<br>
### Logger의 사용
개발단계에서 사용한 `print()`를 릴리즈 빌드에서 제외하고 싶다면 다음과 같이 오버라이드해서 사용할 수 있다.  

```swift
// global print(_ message: String) {    // 외뷰 패키지에서도 참조 가능
func print(_ message: String) {
    #if DEBUG
    Swift.print(message)
    #endif
}
```
`print()`의 사용은 생각보다 퍼포먼스 페널티가 크기 때문에 릴리즈 버젼에서는 삭제하는것이 일반적인데      
Swift에 내장된 'Logger'를 사용하면 개발 페이즈별로 로그를 편리하게 관리할 수 있다.  
in memory에만 저장되는 .debug 레벨을 제외하면 모든 레벨의 로그는 Binary 로 압축저장되어 오버헤드가 적다.  
Binary 파일이지만 Xcode나 Console에서는 로그를 위한 뷰를 당연히 지원한다.  
macOS 11 이하 버전에는 'OSLog'를 사용해야 하는데 여기에 약간의 편의성과 높은 추상화를 적용한것이 'Logger'이다.  
둘의 차이점은 크지 않지만 'OSLog'가 약간의 디테일한 세팅환경을 제공한다.  

##### 로그 레벨
* .debug - 기록X. (OSLog의 경우 자동으로 릴리즈 빌드에서 제외함)
* .info - 기록
* .notice - (default)기록
* .error - 기록
* .fault - 기록  

<br>
```swift
import OSLog

let textName = "CHOI"
Logger().info("Test name : \(textName, privacy: .public)")
Logger().info("Test name : \(textName, privacy: .private)")
Logger().info("Test name : \(textName, privacy: .private(mask: .hash))")

os_log(.default, "default os_log")  // print
os_log("default os_log")            // print
os_log(.debug, "debug os_log")      // no print

let logger = Logger()
logger.info("Logger Test")  // print
logger.debug("Logger Test") // no print

logger.log(level: .debug, "PARK") // no print
logger.log(level: .info , "PARK") // print
logger.log(level: .error , "PARK") // print
```
#각 로그들이 저장되는 위치 확인 방법

이렇게 로그들을 관리하면 디버깅할때 관련 코드들을 컨트롤 할 수 있고 릴리즈 빌드에서 간단하게 제외시킬 수도 있다.
debug 레벨 + 특정 subsystem 로그만 사용하는 예시
'$ sudo log config --mode "level:debug" --subsystem com.your_company.your_subsystem_name'

checking the log level of a subsystem
'$ sudo log config --status --subsystem com.your_company.your_subsystem_name
Mode for 'com.your_company.your_subsystem_name'  DEBUG'

#Logger 사용시 Xcode 에서 릴리즈시 빌드 제외하는 방법

#Console 사용
console 을 사용하면 시스템의 실시간 로그들을 확인 가능한데 
Default 레벨 이상에서만 기록되기 때문에 Debug 레벨에서는 console창에서 확인할 수 없고 Xcode DebugArea 에서만 확인 가능하다.
console 창을 활용해서 process 별로 검색하면 작업하는 프로젝트에서 발생하는 로그를 쉽게 확인 가능하다.

* 변경사항 : Xcode console 에서도 확인 가능함
```swift

import OSLog

// no print
let textName = "CHOI"
Logger().info("Test name : \(textName, privacy: .public)")
Logger().info("Test name : \(textName, privacy: .private)")
Logger().info("Test name : \(textName, privacy: .private(mask: .hash))")


os_log(.default, "os_log .default") // print
os_log("SYSTEM TEST TEST")      // print
os_log(.debug, "os_log .debug") // no print

logger.info("Logger Test")  // print
logger.debug("Logger Test") // no print

let logger = Logger()
logger.log(level: .debug, "PARK")   // no print
logger.log(level: .fault , "PARK") // print
```