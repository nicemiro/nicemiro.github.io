---
title: 'Logger, OSLog'
titleEn:
author: BabyK
date: 2024-08-23
category: iOS
layout: post
tags: [iOS, Swift, Xcode]
published: true
---
<br>
### Logger의 사용
개발단계에서 사용한 `print()`를 릴리즈 빌드에서 제외하고 싶다면 다음과 같이 오버라이드해서 사용할 수 있다.  

```swift
// global print(_ message: String) {    // 외뷰 패키지에서도 참조 가능
func print(_ message: String) {
    #if DEBUG
    Swift.print(message)
    #endif
}
```
`print()`의 사용은 생각보다 퍼포먼스 페널티가 크기 때문에 릴리즈 빌드에서는 제외하는 것이 일반적이다.  
대신 Swift에 내장된 OSLog, Logger를 사용하면 개발 페이즈별로 로그를 편리하게 관리할 수 있는데  
in memory에만 저장되는 .debug 레벨을 제외하면 모두 Binary 로 압축저장되어 오버헤드가 적다.  
Binary 파일이지만 Xcode나 Console에서는 로그를 위한 뷰를 당연히 지원한다.  
macOS 11 이하 버전에는 OSLog를 사용해야 하는데 약간의 편의성과 높은 추상화를 적용한것이 Logger.    
둘의 차이점은 크지 않지만 OSLog가 약간의 디테일한 세팅환경을 제공한다.

#### 로그 레벨
<table>
    <tr>
        <td>debug</td>
        <td>in-memory only</td>
    </tr>
    <tr>
        <td>info</td>
        <td>in-memory only</td>
    </tr>
    <tr>
        <td>notice</td>
        <td>default. in-memory, on-disk storage</td>
    </tr>
    <tr>
        <td>error</td>
        <td>both </td>
    </tr>
    <tr>
        <td>fault</td>
        <td>both</td>
    </tr>
</table>
<br>

```swift
import OSLog

let firstName = "Michale"
let lastName = "Choi"
let address = "Seoul South Korea"
let mobile = "82-10-"

// subsystem, category 사용
let logger = Logger(subsystem: "com.logger.test", category: "test")
logger.info(" .info level log with its subsystem and category")

// debug 환경에서는 보이지만 release 에서는 값이 마스킹되거나 숨겨짐
logger.log("First Name: \(firstName, privacy: .private)")
logger.log("Mobile : \(firstName, privacy: .private(mask: .hash))")
logger.log("Address : \(firstName, privacy: .sensitive)")
logger.log("Address : \(firstName, privacy: .public)")  // visible


let defaultLogger = Logger(.default)
defaultLogger.debug("test")

Logger().debug("name : \(lastName)")
Logger().info("name : \(lastName)")
Logger().notice("name : \(lastName, privacy: .public)")
Logger().log("name : \(lastName, privacy: .public)")   // .notice
Logger().error("Error")
Logger().fault("Fault")

os_log(.default, "os_log .default")
os_log("log")
os_log(.debug, "os_log .debug")
```
<br>

#### subsystem으로 필터링한 로그의 확인
##### 터미널
<img src="/img/ios/2024-08-23-OSLog_1.png" style="width:100%">


##### Console
<img src="/img/ios/2024-08-23-OSLog_0.png" style="width:100%">

##### Xcode
<img src="/img/ios/2024-08-23-OSLog_2.png" style="width:100%">


<!-- #로그파일 위치 확인 -->
<!-- #Logger 사용시 Xcode 에서 릴리즈시 빌드 제외하는 방법 -->

<br>